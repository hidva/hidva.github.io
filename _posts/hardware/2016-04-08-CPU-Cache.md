---
title: Cpu Cache 简单介绍
---

嗯,...,真的是很简单的介绍咯 @_@

## CPU Cache 为何引入

*   一张比较直观的时间图:

    -   execute typical instruction; 1 ns;
    -   L1 cache reference,从 L1 cache 中取数据; 0.5 ns 
    -   L2 cache reference,从 L2 cache 中取数据; 7 ns
    -   Main memory reference,从主存中取数据; 100 ns;

*   所以有必要引入 CPU Cache

## CPU Cache 实现

这里真是很简单的一点点内容 @_@

*   CPU Cache 模型;参考'MESI protocol'.
*   CPU Cache 如何工作;

    -   对于 CPU 而言,数据并没有类型,有无符号这些概念;对于 CPU 而言,这些都是一块一块的数据.
    -   在 CPU 需要读取主存上的数据时,其会把该数据周围数据(一般是 Cache line 大小,64 byte)先
        一同加载到 CPU Cache 中.这个应该是根据程序的局部性原理决定的.

*   Cache associativity;缓存关联性,指定了 CPU Cache 与 Memory 之间如何关联,如何映射.

*   Cache 一致性;参见'MESI protocol'协议.


## CPU Cache 友好的习惯

*   其实,我觉得这些亲近硬件的东西应该是编译器的锅,她应该根据源码行为以及目标平台然后生成缓存友好的
    代码.

### 避免 false sharing




## 参考

*   [高性能服务端系列 -- 处理器篇][0]
*   [Latency Numbers Every Programmer Should Know][1]


[0]: <http://zhuanlan.zhihu.com/p/20478552> 
[1]: <https://gist.github.com/jboner/2841832>


